import{_ as h}from"./42Az2i64.js";import{B as R,C as q,q as D,s as g,j as U,c as A,a as o,b as s,w as y,l as r,o as N,A as j,k as a}from"./DhNaSuU-.js";import{u as E}from"./CqJylN-A.js";import{u as I}from"./-WU5Ls9F.js";const L={class:"max-w-4xl mx-auto"},z={class:"flex items-center justify-between mb-8"},M={class:"space-y-6"},$={class:"field"},F={class:"field"},G={class:"field"},H={class:"field"},J={class:"flex items-center space-x-4 mt-6"},X={__name:"new",async setup(K){let i,c;const m=E(),v=R(),p=q(),w=D(),t=g({title:"",content:"",category_id:null,rating:null,is_published:!0}),u=g(!1),{data:b}=([i,c]=U(async()=>I("categories",async()=>{const{data:l}=await m.from("categories").select("*").order("name");return l})),i=await i,c(),i),x=l=>l.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),f=async()=>{u.value=!0;try{const{error:l}=await m.from("reviews").insert({title:t.value.title,slug:x(t.value.title),content:t.value.content,category_id:t.value.category_id,rating:t.value.rating,user_id:v.value.id,is_published:t.value.is_published});if(l)throw l;p.add({severity:"success",summary:"Success",detail:"Review created successfully",life:3e3}),w.push("/admin/reviews")}catch(l){p.add({severity:"error",summary:"Error",detail:l.message,life:3e3})}finally{u.value=!1}},V=()=>{t.value.is_published=!1,f()};return(l,e)=>{const d=r("Button"),C=h,S=r("InputText"),_=r("Dropdown"),k=r("Textarea"),T=r("Card"),B=r("Toast");return N(),A("div",L,[o("div",z,[e[4]||(e[4]=o("h1",{class:"text-3xl font-bold text-gray-900"},"Create New Review",-1)),s(C,{to:"/admin/reviews"},{default:y(()=>[s(d,{label:"Back to Reviews",icon:"pi pi-arrow-left",severity:"secondary"})]),_:1})]),s(T,null,{content:y(()=>[o("div",M,[o("form",{onSubmit:j(f,["prevent"])},[o("div",$,[e[5]||(e[5]=o("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1)),s(S,{id:"title",modelValue:a(t).title,"onUpdate:modelValue":e[0]||(e[0]=n=>a(t).title=n),class:"w-full",required:""},null,8,["modelValue"])]),o("div",F,[e[6]||(e[6]=o("label",{for:"category",class:"block text-sm font-medium text-gray-700"},"Category",-1)),s(_,{id:"category",modelValue:a(t).category_id,"onUpdate:modelValue":e[1]||(e[1]=n=>a(t).category_id=n),options:a(b),"option-label":"name","option-value":"id",placeholder:"Select a category",class:"w-full",required:""},null,8,["modelValue","options"])]),o("div",G,[e[7]||(e[7]=o("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"Content",-1)),s(k,{id:"content",modelValue:a(t).content,"onUpdate:modelValue":e[2]||(e[2]=n=>a(t).content=n),rows:"10",class:"w-full",required:""},null,8,["modelValue"])]),o("div",H,[e[8]||(e[8]=o("label",{for:"rating",class:"block text-sm font-medium text-gray-700"},"Rating",-1)),s(_,{id:"rating",modelValue:a(t).rating,"onUpdate:modelValue":e[3]||(e[3]=n=>a(t).rating=n),options:[1,2,3,4,5],placeholder:"Select a rating",class:"w-full",required:""},null,8,["modelValue"])]),o("div",J,[s(d,{type:"submit",loading:a(u),label:"Create Review"},null,8,["loading"]),s(d,{type:"button",severity:"secondary",label:"Save as Draft",onClick:V})])],32)])]),_:1}),s(B)])}}};export{X as default};
