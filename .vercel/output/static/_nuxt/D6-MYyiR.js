import{_ as R}from"./C9o6SUgA.js";import{u as D}from"./ByTvV72R.js";import{u as f}from"./vtWOP-mq.js";import{j as g,c as u,a as t,b as r,t as i,k as m,w as n,l as U,o as _,d as p,F as v,r as h,G as M}from"./Bf3otjuS.js";import{f as N}from"./sbWH3_uq.js";const T={class:"max-w-7xl mx-auto"},V={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},B={class:"card"},E={class:"text-3xl font-bold text-primary-600"},j={class:"card"},q={class:"text-3xl font-bold text-primary-600"},F={class:"card"},L={class:"text-3xl font-bold text-primary-600"},P={class:"card"},S={class:"text-3xl font-bold text-primary-600"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},z={class:"space-y-4"},G={class:"space-y-4"},I={class:"space-y-4"},Q={class:"space-y-4"},H={class:"flex-shrink-0"},J={class:"ml-3"},K={class:"text-sm text-gray-900"},O={class:"text-xs text-gray-500"},W={class:"space-y-6"},X={class:"flex justify-between items-center"},Y={class:"overflow-x-auto"},Z={class:"min-w-full divide-y divide-gray-200"},tt={class:"bg-white divide-y divide-gray-200"},et={class:"px-6 py-4 whitespace-nowrap"},st={class:"text-sm font-medium text-gray-900"},ot={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap"},rt={class:"star-rating"},nt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"text-sm text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap text-sm"},ct=["onClick"],gt={__name:"index",async setup(mt){let s,c;const l=D(),{data:y}=([s,c]=g(async()=>f("admin-stats",async()=>{const[{count:o},{count:e},{count:d},{count:x}]=await Promise.all([l.from("reviews").select("*",{count:"exact",head:!0}),l.from("profiles").select("*",{count:"exact",head:!0}),l.from("profiles").select("*",{count:"exact",head:!0}).eq("is_premium",!0),l.from("comments").select("*",{count:"exact",head:!0})]);return{totalReviews:o,totalUsers:e,premiumUsers:d,totalComments:x}})),s=await s,c(),s),{data:b}=([s,c]=g(async()=>f("recent-activity",async()=>{const{data:o}=await l.from("activity_log").select("*").order("created_at",{ascending:!1}).limit(5);return o})),s=await s,c(),s),{data:k}=([s,c]=g(async()=>f("recent-reviews",async()=>{const{data:o}=await l.from("reviews").select(`
      *,
      author:profiles(*)
    `).order("created_at",{ascending:!1}).limit(5);return o})),s=await s,c(),s),w=o=>N(new Date(o),"MMM d, yyyy"),C=o=>({review_created:"pi pi-file",review_updated:"pi pi-pencil",user_registered:"pi pi-user",comment_added:"pi pi-comment"})[o]||"pi pi-info-circle",A=async o=>{if(confirm("Are you sure you want to delete this review?"))try{await l.from("reviews").delete().eq("id",o),window.location.reload()}catch(e){console.error("Error deleting review:",e)}};return(o,e)=>{const d=R,x=U("Card");return _(),u("div",T,[e[14]||(e[14]=t("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"Admin Dashboard",-1)),t("div",V,[t("div",B,[e[0]||(e[0]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Total Reviews",-1)),t("p",E,i(m(y).totalReviews),1)]),t("div",j,[e[1]||(e[1]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Total Users",-1)),t("p",q,i(m(y).totalUsers),1)]),t("div",F,[e[2]||(e[2]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Premium Users",-1)),t("p",L,i(m(y).premiumUsers),1)]),t("div",P,[e[3]||(e[3]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Total Comments",-1)),t("p",S,i(m(y).totalComments),1)])]),t("div",$,[r(x,null,{content:n(()=>[t("div",z,[e[7]||(e[7]=t("h3",{class:"text-lg font-medium text-gray-900"},"Quick Actions",-1)),t("div",G,[r(d,{to:"/admin/reviews/new",class:"btn-primary block text-center"},{default:n(()=>e[4]||(e[4]=[p(" Create New Review ")])),_:1,__:[4]}),r(d,{to:"/admin/categories",class:"btn-secondary block text-center"},{default:n(()=>e[5]||(e[5]=[p(" Manage Categories ")])),_:1,__:[5]}),r(d,{to:"/admin/users",class:"btn-secondary block text-center"},{default:n(()=>e[6]||(e[6]=[p(" Manage Users ")])),_:1,__:[6]})])])]),_:1}),r(x,null,{content:n(()=>[t("div",I,[e[8]||(e[8]=t("h3",{class:"text-lg font-medium text-gray-900"},"Recent Activity",-1)),t("div",Q,[(_(!0),u(v,null,h(m(b),a=>(_(),u("div",{key:a.id,class:"flex items-start"},[t("div",H,[t("i",{class:M([C(a.type),"text-gray-400"])},null,2)]),t("div",J,[t("p",K,i(a.description),1),t("p",O,i(w(a.created_at)),1)])]))),128))])])]),_:1})]),r(x,null,{content:n(()=>[t("div",W,[t("div",X,[e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-gray-900"},"Recent Reviews",-1)),r(d,{to:"/admin/reviews",class:"text-primary-600 hover:text-primary-700"},{default:n(()=>e[9]||(e[9]=[p(" View All ")])),_:1,__:[9]})]),t("div",Y,[t("table",Z,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Title "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Author "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rating "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",tt,[(_(!0),u(v,null,h(m(k),a=>(_(),u("tr",{key:a.id},[t("td",et,[t("div",st,i(a.title),1)]),t("td",ot,[t("div",at,i(a.author.full_name),1)]),t("td",it,[t("div",rt,[e[11]||(e[11]=t("i",{class:"pi pi-star-fill mr-1"},null,-1)),p(" "+i(a.rating),1)])]),t("td",nt,[t("div",lt,i(w(a.created_at)),1)]),t("td",dt,[r(d,{to:`/admin/reviews/${a.id}`,class:"text-primary-600 hover:text-primary-900 mr-4"},{default:n(()=>e[12]||(e[12]=[p(" Edit ")])),_:2,__:[12]},1032,["to"]),t("button",{onClick:pt=>A(a.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ct)])]))),128))])])])])]),_:1})])}}};export{gt as default};
