import{C as N,D as U,s as x,j,c as g,a as t,b as i,w as _,k as n,J as F,l as d,o as w,F as I,r as L,t as h,A as z}from"./DhNaSuU-.js";import{u as J}from"./CqJylN-A.js";import{u as M}from"./-WU5Ls9F.js";const R={class:"max-w-4xl mx-auto"},G={class:"flex items-center justify-between mb-8"},H={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},O={class:"bg-white divide-y divide-gray-200"},P={class:"px-6 py-4 whitespace-nowrap"},Q={class:"text-sm font-medium text-gray-900"},W={class:"px-6 py-4 whitespace-nowrap"},X={class:"text-sm text-gray-500"},Y={class:"px-6 py-4"},Z={class:"text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm"},te=["onClick"],se=["onClick"],ae={class:"field"},oe={class:"field"},de={__name:"index",async setup(ie){let m,C;const u=J(),p=N(),k=U(),r=x(!1),y=x(!1),c=x(null),o=x({name:"",description:""}),{data:f}=([m,C]=j(async()=>M("admin-categories",async()=>{const{data:s}=await u.from("categories").select("*").order("name");return s})),m=await m,C(),m),D=s=>s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),S=s=>{c.value=s,o.value={name:s.name,description:s.description||""},r.value=!0},b=async()=>{y.value=!0;try{const s={name:o.value.name,slug:D(o.value.name),description:o.value.description};let e;if(c.value?e=(await u.from("categories").update(s).eq("id",c.value.id)).error:e=(await u.from("categories").insert(s)).error,e)throw e;const{data:l}=await u.from("categories").select("*").order("name");f.value=l,r.value=!1,c.value=null,o.value={name:"",description:""},p.add({severity:"success",summary:"Success",detail:`Category ${c.value?"updated":"created"} successfully`,life:3e3})}catch(s){p.add({severity:"error",summary:"Error",detail:s.message,life:3e3})}finally{y.value=!1}},V=s=>{k.require({message:"Are you sure you want to delete this category?",header:"Confirm Deletion",icon:"pi pi-exclamation-triangle",accept:async()=>{try{const{error:e}=await u.from("categories").delete().eq("id",s);if(e)throw e;f.value=f.value.filter(l=>l.id!==s),p.add({severity:"success",summary:"Success",detail:"Category deleted successfully",life:3e3})}catch(e){p.add({severity:"error",summary:"Error",detail:e.message,life:3e3})}}})};return(s,e)=>{const l=d("Button"),v=d("Card"),A=d("InputText"),T=d("Textarea"),E=d("Dialog"),$=d("Toast"),B=d("ConfirmDialog");return w(),g("div",R,[t("div",G,[e[5]||(e[5]=t("h1",{class:"text-3xl font-bold text-gray-900"},"Categories",-1)),i(l,{onClick:e[0]||(e[0]=a=>r.value=!0),label:"Add Category",icon:"pi pi-plus"})]),i(v,null,{content:_(()=>[t("div",H,[t("table",K,[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Slug "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",O,[(w(!0),g(I,null,L(n(f),a=>(w(),g("tr",{key:a.id},[t("td",P,[t("div",Q,h(a.name),1)]),t("td",W,[t("div",X,h(a.slug),1)]),t("td",Y,[t("div",Z,h(a.description),1)]),t("td",ee,[t("button",{onClick:q=>S(a),class:"text-primary-600 hover:text-primary-900 mr-4"}," Edit ",8,te),t("button",{onClick:q=>V(a.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,se)])]))),128))])])])]),_:1}),i(E,{visible:n(r),"onUpdate:visible":e[4]||(e[4]=a=>F(r)?r.value=a:null),modal:!0,header:n(c)?"Edit Category":"Add Category",class:"p-fluid"},{default:_(()=>[t("form",{onSubmit:z(b,["prevent"]),class:"space-y-4"},[t("div",ae,[e[7]||(e[7]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),i(A,{id:"name",modelValue:n(o).name,"onUpdate:modelValue":e[1]||(e[1]=a=>n(o).name=a),required:""},null,8,["modelValue"])]),t("div",oe,[e[8]||(e[8]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),i(T,{id:"description",modelValue:n(o).description,"onUpdate:modelValue":e[2]||(e[2]=a=>n(o).description=a),rows:"3"},null,8,["modelValue"])])],32)]),footer:_(()=>[i(l,{label:"Cancel",icon:"pi pi-times",onClick:e[3]||(e[3]=a=>r.value=!1),severity:"secondary",class:"mr-2"}),i(l,{label:"Save",icon:"pi pi-check",onClick:b,loading:n(y)},null,8,["loading"])]),_:1},8,["visible","header"]),i($),i(B)])}}};export{de as default};
