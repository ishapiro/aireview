import{D as C,j as b,c as r,a as e,b as n,w as D,l as m,o as c,F as A,r as T,k as S,t as p}from"./Bf3otjuS.js";import{u as E}from"./ByTvV72R.js";import{u as M}from"./vtWOP-mq.js";import{f as U}from"./sbWH3_uq.js";const j={class:"max-w-7xl mx-auto"},q={class:"overflow-x-auto"},B={class:"min-w-full divide-y divide-gray-200"},F={class:"bg-white divide-y divide-gray-200"},N={class:"px-6 py-4 whitespace-nowrap"},$={class:"flex items-center"},I={class:"flex-shrink-0 h-10 w-10"},R=["src"],V={key:1,class:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},J={class:"ml-4"},L={class:"text-sm font-medium text-gray-900"},P={class:"px-6 py-4 whitespace-nowrap"},z={class:"text-sm text-gray-900"},G={class:"px-6 py-4 whitespace-nowrap"},H={class:"px-6 py-4 whitespace-nowrap"},K={class:"px-6 py-4 whitespace-nowrap"},O={class:"text-sm text-gray-500"},Q={class:"px-6 py-4 whitespace-nowrap text-sm"},W=["onClick"],X=["onClick"],ae={__name:"index",async setup(Y){let d,x;const u=E(),l=useToast(),y=C(),{data:o}=([d,x]=b(async()=>M("admin-users",async()=>{const{data:s}=await u.from("profiles").select("*").order("created_at",{ascending:!1});return s})),d=await d,x(),d),f=s=>U(new Date(s),"MMM d, yyyy"),h=async s=>{try{const{error:t}=await u.from("profiles").update({is_admin:!s.is_admin}).eq("id",s.id);if(t)throw t;const i=o.value.findIndex(_=>_.id===s.id);i!==-1&&(o.value[i].is_admin=!s.is_admin),l.add({severity:"success",summary:"Success",detail:`User ${s.is_admin?"removed from":"made"} admin successfully`,life:3e3})}catch(t){l.add({severity:"error",summary:"Error",detail:t.message,life:3e3})}},v=s=>{y.require({message:"Are you sure you want to delete this user? This action cannot be undone.",header:"Confirm Deletion",icon:"pi pi-exclamation-triangle",accept:async()=>{try{const{error:t}=await u.from("profiles").delete().eq("id",s);if(t)throw t;o.value=o.value.filter(i=>i.id!==s),l.add({severity:"success",summary:"Success",detail:"User deleted successfully",life:3e3})}catch(t){l.add({severity:"error",summary:"Error",detail:t.message,life:3e3})}}})};return(s,t)=>{const i=m("Tag"),_=m("Card"),g=m("Toast"),w=m("ConfirmDialog");return c(),r("div",j,[t[2]||(t[2]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"Users",-1)),n(_,null,{content:D(()=>[e("div",q,[e("table",B,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Joined "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",F,[(c(!0),r(A,null,T(S(o),a=>(c(),r("tr",{key:a.id},[e("td",N,[e("div",$,[e("div",I,[a.avatar_url?(c(),r("img",{key:0,src:a.avatar_url,class:"h-10 w-10 rounded-full object-cover"},null,8,R)):(c(),r("div",V,t[0]||(t[0]=[e("i",{class:"pi pi-user text-gray-400"},null,-1)])))]),e("div",J,[e("div",L,p(a.full_name),1)])])]),e("td",P,[e("div",z,p(a.email),1)]),e("td",G,[n(i,{value:a.is_admin?"Admin":"User",severity:a.is_admin?"danger":"info"},null,8,["value","severity"])]),e("td",H,[n(i,{value:a.is_premium?"Premium":"Free",severity:a.is_premium?"success":"warning"},null,8,["value","severity"])]),e("td",K,[e("div",O,p(f(a.created_at)),1)]),e("td",Q,[e("button",{onClick:k=>h(a),class:"text-primary-600 hover:text-primary-900 mr-4"},p(a.is_admin?"Remove Admin":"Make Admin"),9,W),e("button",{onClick:k=>v(a.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,X)])]))),128))])])])]),_:1}),n(g),n(w)])}}};export{ae as default};
